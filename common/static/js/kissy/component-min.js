/*
Copyright 2012, KISSY UI Library v1.30dev
MIT Licensed
build time: Apr 13 14:49
*/
KISSY.add("component/Controller",function(g,f,e,a,c){function h(d){return function(b){var b=b.newVal,a=this.get("view");a&&a.set(d,b)}}function j(d){return function(b){var a=this.get("view");return void 0===b?a&&a.get(d):b}}function i(d,b,a){d.create();var c=d.getContentElement();b.__set("parent",d);b.set("render",c);b.set("elBefore",a);d.get("rendered")?b.render():b.create()}function k(d){if(d.__componentClasses)return d.__componentClasses;for(var b=d.constructor,c=[];b&&b!=l;){var e=a.getClsByUI(b);
e&&c.push(e);b=b.superclass&&b.superclass.constructor}return d.__componentClasses=c.join(" ")}var l=e.create([e.Box],{getCls:a.getCls,initializer:function(){var d=this.__attrs||{},b;for(b in d)if(d.hasOwnProperty(b)){var a=d[b];a.view&&(this.on("after"+(b.charAt(0).toUpperCase()+b.substring(1))+"Change",h(b)),a.getter=j(b))}},renderUI:function(){var d,b;this.get("view").render();var a=this.get("children");for(d=0;d<a.length;d++)b=a[d],i(this,b),b.render()},createDom:function(){var d;if(!(d=this.get("view"))){d=
this.constructor;for(var b;d&&!b;)b=d.DefaultRender,d=d.superclass&&d.superclass.constructor;if(b){d=this.__attrs||{};var a={},c;for(c in d)if(d.hasOwnProperty(c)){var e;if(d[c].view&&void 0!==(e=this.get(c)))a[c]=e}d=new b(a)}else d=0}b=d;b.create();b._renderCls(k(this));this.get("allowTextSelection_")||b.get("el").unselectable();this.__set("view",b)},getContentElement:function(){var d=this.get("view");return d&&d.getContentElement()},addChild:function(d,b){var a=this.get("children"),c=null;void 0!==
b?(a.splice(b,0,d),c=a[b]||null):a.push(d);i(this,d,c)},removeChild:function(d,b){var a=this.get("children"),c=g.indexOf(d,a);-1!=c&&a.splice(c,1);b&&d.destroy()},removeChildren:function(d){var b,a=[].concat(this.get("children"));for(b=0;b<a.length;b++)this.removeChild(a[b],d);this.__set("children",[])},getChildAt:function(d){return this.get("children")[d]},_uiSetHandleMouseEvents:function(d){var b=this.get("el");d?(b.on("mouseenter",this._handleMouseEnter,this),b.on("mouseleave",this._handleMouseLeave,
this),b.on("mousedown",this._handleMouseDown,this),b.on("mouseup",this._handleMouseUp,this),b.on("dblclick",this._handleDblClick,this)):(b.detach("mouseenter",this._handleMouseEnter,this),b.detach("mouseleave",this._handleMouseLeave,this),b.detach("mousedown",this._handleMouseDown,this),b.detach("mouseup",this._handleMouseUp,this),b.detach("dblclick",this._handleDblClick,this))},_handleDblClick:function(d){this.get("disabled")||this._performInternal(d)},_isMouseEventWithinElement:function(d,b){var a=
d.relatedTarget;if(!a)return!1;if(a===b[0]||b.contains(a))return!0},_handleMouseOver:function(d){var a=this.get("el");if(this.get("disabled"))return!0;this._isMouseEventWithinElement(d,a)||this._handleMouseEnter(d)},_handleMouseOut:function(d){var a=this.get("el");if(this.get("disabled"))return!0;this._isMouseEventWithinElement(d,a)||this._handleMouseLeave(d)},_handleMouseEnter:function(){if(this.get("disabled"))return!0;this.set("highlighted",!0)},_handleMouseLeave:function(){if(this.get("disabled"))return!0;
this.set("active",!1);this.set("highlighted",!1)},_handleMouseDown:function(a){var b;if(this.get("disabled"))return!0;1==a.which&&this.get("activeable")&&this.set("active",!0);b=this.getKeyEventTarget();1==a.which&&0<=b.attr("tabindex")&&b[0].focus();1==a.which&&!this.get("allowTextSelection_")&&(b=(b=a.target.nodeName)&&b.toLowerCase(),"input"!=b&&"textarea"!=b&&a.preventDefault())},_uiSetFocusable:function(a){var b=this.getKeyEventTarget();a?(b.on("focus",this._handleFocus,this),b.on("blur",this._handleBlur,
this),b.on("keydown",this._handleKeydown,this)):(b.detach("focus",this._handleFocus,this),b.detach("blur",this._handleBlur,this),b.detach("keydown",this._handleKeydown,this))},_uiSetFocused:function(a){this._forwardSetAttrToView("focused",a)},_uiSetHighlighted:function(a){this._forwardSetAttrToView("highlighted",a)},_forwardSetAttrToView:function(a,b){var c=this.get("view");c["_set"+(a.charAt(0).toUpperCase()+a.substring(1))].call(c,b,k(this))},_uiSetDisabled:function(a){this._forwardSetAttrToView("disabled",
a)},_uiSetActive:function(a){this._forwardSetAttrToView("active",a)},getKeyEventTarget:function(){return this.get("view").getKeyEventTarget()},_handleMouseUp:function(a){if(this.get("disabled"))return!0;this.get("active")&&1==a.which&&(this._performInternal(a),this.set("active",!1))},_handleFocus:function(){this.set("focused",!0)},_handleBlur:function(){this.set("focused",!1)},_handleKeyEventInternal:function(a){if(a.keyCode==f.KeyCodes.ENTER)return this._performInternal(a)},_handleKeydown:function(a){if(this.get("disabled"))return!0;
if(this._handleKeyEventInternal(a))return a.halt(),!0},_performInternal:function(){},destructor:function(){var a,b=this.get("children");for(a=0;a<b.length;a++)b[a].destroy();(a=this.get("view"))&&a.destroy()}},{ATTRS:{handleMouseEvents:{value:!0},focusable:{view:!0,value:!0},activeable:{value:!0},focused:{},active:{},highlighted:{},children:{value:[]},prefixCls:{view:!0,value:"ks-"},parent:{},view:{},disabled:{},allowTextSelection_:{value:!1}},DefaultRender:c},"Component_Controller");return l},{requires:["event",
"uibase","./uistore","./render"]});KISSY.add("component",function(g,f,e,a,c,h,j,i){g={Controller:f,Render:e,Container:a,UIStore:c,DelegateChildren:h,DecorateChild:i,DecorateChildren:j};g.Controller=f;return g},{requires:"component/Controller,component/render,component/container,component/uistore,component/delegatechildren,component/decoratechildren,component/decoratechild".split(",")});
KISSY.add("component/container",function(g,f,e,a,c,h){return f.create(e,[c,h])},{requires:["uibase","./Controller","./uistore","./delegatechildren","./decoratechildren"]});KISSY.add("component/decoratechild",function(g,f){function e(){}g.augment(e,f,{decorateInternal:function(a){this.set("el",a);var c=this.get("decorateChildCls"),e=this.get("prefixCls");if(a=a.one("."+this.getCls(c)))(c=this._findUIByClass(a))?this.decorateChildrenInternal(c,a,e):this.decorateChildren(a)}});return e},{requires:["./decoratechildren"]});
KISSY.add("component/decoratechildren",function(g,f){function e(){}g.augment(e,{decorateInternal:function(a){this.set("el",a);this.decorateChildren(a)},decorateChildrenInternal:function(a,c,e){this.addChild(new a({srcNode:c,prefixCls:e}))},_findUIByClass:function(a){var a=a.attr("class")||"",c=this.get("prefixCls"),a=a.replace(RegExp("\\b"+c,"ig"),"");return f.getUIByClass(a)},decorateChildren:function(a){var c=this,a=a.children(),e=c.get("prefixCls");a.each(function(a){var f=c._findUIByClass(a);
c.decorateChildrenInternal(f,a,e)})}});return e},{requires:["./uistore"]});
KISSY.add("component/delegatechildren",function(g){function f(){}g.augment(f,{__bindUI:function(){this.get("el").on("mousedown mouseup mouseover mouseout dblclick",this._handleChildMouseEvents,this)},_handleChildMouseEvents:function(e){var a=this.getOwnerControl(e.target);if(a)switch(e.type){case "mousedown":a._handleMouseDown(e);break;case "mouseup":a._handleMouseUp(e);break;case "mouseover":a._handleMouseOver(e);break;case "mouseout":a._handleMouseOut(e);break;case "dblclick":a._handleDblClick(e)}},
getOwnerControl:function(e){for(var a=this.get("children"),c=a.length,h=this.get("el")[0];e&&e!==h;){for(var f=0;f<c;f++)if(a[f].get("el")[0]===e)return a[f];e=e.parentNode}return null}});return f});
KISSY.add("component/render",function(g,f,e){function a(a,e,f){return a.getCls(e.split(/\s+/).join(f+" ")+f)}return f.create([f.Box.Render],{_completeClasses:function(c,e){return a(this,c,e)},_renderCls:function(a){this.get("el").addClass(this.getCls(a))},getCls:e.getCls,getKeyEventTarget:function(){return this.get("el")},getContentElement:function(){return this.get("contentEl")||this.get("el")},_uiSetFocusable:function(a){var e=this.getKeyEventTarget(),f=e.attr("tabindex");0<=f&&!a?e.attr("tabindex",
-1):!(0<=f)&&a&&e.attr("tabindex",0)},_setHighlighted:function(c,e){this.get("el")[c?"addClass":"removeClass"](a(this,e,"-hover"))},_setDisabled:function(c,e){this.get("el")[c?"addClass":"removeClass"](a(this,e,"-disabled")).attr({tabindex:c?-1:0,"aria-disabled":c})},_setActive:function(c,e){this.get("el")[c?"addClass":"removeClass"](a(this,e,"-active")).attr("aria-pressed",!!c)},_setFocused:function(c,e){this.get("el")[c?"addClass":"removeClass"](a(this,e,"-focused"))}},{ATTRS:{prefixCls:{},focusable:{}}},
"Component_Render")},{requires:["uibase","./uistore"]});
KISSY.add("component/uistore",function(g){function f(a){for(var c in e)if(e[c].ui==a)return c;return 0}var e={};return{getCls:function(a){for(var a=g.trim(a).split(/\s+/),c=0;c<a.length;c++)a[c]&&(a[c]=this.get("prefixCls")+a[c]);return a.join(" ")},getClsByUI:f,getClsByInstance:function(a){return f(a.constructor)},getUIByClass:function(a){for(var a=a.split(/\s+/),c=null,f=0;f<a.length;f++){var g=e[a[f]];g&&-1<g.priority&&(c=g.ui)}return c},setUIByClass:function(a,c){e[a]=c},PRIORITY:{LEVEL1:10,LEVEL2:20,
LEVEL3:30,LEVEL4:40,LEVEL5:50,LEVEL6:60}}});
